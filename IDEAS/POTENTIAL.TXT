more advanced stack based turn system